"use strict";

$(document).ready(function () {
  // Отключение / включение скролла на странице
  var bodyScrollControls = {
    scrollBarWidth: window.innerWidth - $('body').clientWidth,
    disable: function disable() {
      $('body').css('margin-right', "".concat(this.scrollBarWidth, "px"));
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        $('body').css('margin-right', 'null');
      }
      $('html').addClass('stop-scroll');
    },
    enable: function enable() {
      $('body').css('margin-right', 'null');
      $('html').removeClass('stop-scroll');
    }
  };

  // Product Swiper
  var thumbsSwiper = new Swiper('.thumbs-swiper', {
    spaceBetween: 13,
    slidesPerView: 7,
    freeMode: true,
    watchSlidesProgress: true,
    breakpoints: {
      991: {
        slidesPerView: 7,
        spaceBetween: 5
      },
      320: {
        slidesPerView: 5.8,
        spaceBetween: 14
      }
    }
  });
  var productSwiper = new Swiper(".product-swiper", {
    loop: true,
    spaceBetween: 10,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev"
    },
    thumbs: {
      swiper: thumbsSwiper
    }
  });

  // Add to fav
  $('.product__fav').click(function () {
    $(this).toggleClass('active');
    var favStatus = !!$(this).hasClass('active'),
      favText = favStatus ? "В избранном" : "В избранное";
    $(this).find('.text-12').text(favText);
  });

  // Accordion
  $(function () {
    $("#accordion").accordion({
      collapsible: true,
      active: false,
      heightStyle: "content"
    });
  });

  // Popups
  $('.product-feedback').click(function () {
    enablePopup();

    // Клик по оверлэю
    $('.product__overlay').click(function (evt) {
      var target = $(evt.target);
      if (target.is('.product__overlay')) {
        disablePopup();
      }
    });
    // Клики по кнопкам закрытия попапов или кнопке Ок
    $('.popup__close-btn, .popup__confirm-btn').click(function () {
      disablePopup();
    });
    $('.popup__confirm-btn').click(function () {
      $('.popup--thanks').removeClass('active');
      $('.popup--form .form__input').val('');
      $('#form #submit-btn').attr('disabled', true);
      $('.popup--form').addClass('active');
    });
    // После успешной отправки формы показываем второй попап
    $('#form').submit(function () {
      $('.popup--form').removeClass('active');
      $('.popup--thanks').addClass('active');
    });
  });
  function enablePopup() {
    $('.product__overlay').addClass('active');
    bodyScrollControls.disable();
  }
  function disablePopup() {
    $('.product__overlay').removeClass('active');
    bodyScrollControls.enable();
  }

  // Form
  //// Disable Form Btn
  var filledFields,
    fieldsNum = $('#form .form__input').length;
  $('#form #submit-btn').attr('disabled', true);
  $('#form .form__input').each(function (i, elem) {
    $(elem).keyup(function () {
      filledFields = 0;
      $('#form .form__input').each(function (i, elem) {
        if ($(elem).val() !== '') {
          filledFields++;
        }
      });
      $('#form #submit-btn').attr('disabled', !(filledFields === fieldsNum));
    });
  });

  //// Mask
  var selector = document.getElementById('phone');
  var im = new Inputmask('+7 (999) 999-99-99');
  im.mask(selector);

  //// Validate
  var validation = new JustValidate('#form', {
    errorFieldCssClass: 'is-invalid',
    errorLabelCssClass: 'is-label-invalid',
    errorLabelStyle: {
      color: '#ef6461'
    }
  });
  validation.addField('#name', [{
    rule: 'minLength',
    value: 2,
    errorMessage: 'Слишком короткое имя'
  }, {
    rule: 'maxLength',
    value: 30,
    errorMessage: 'Слишком длинное имя'
  }, {
    rule: 'required',
    errorMessage: 'Вы не ввели имя'
  }]).addField('#phone', [{
    rule: 'required',
    errorMessage: 'Вы не ввели телефон'
  }, {
    validator: function validator(name, value) {
      var phone = selector.inputmask.unmaskedvalue();
      return phone.length === 10;
    },
    errorMessage: 'Введите 10 символов'
  }]);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJib2R5U2Nyb2xsQ29udHJvbHMiLCJzY3JvbGxCYXJXaWR0aCIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJjbGllbnRXaWR0aCIsImRpc2FibGUiLCJjc3MiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiYWRkQ2xhc3MiLCJlbmFibGUiLCJyZW1vdmVDbGFzcyIsInRodW1ic1N3aXBlciIsIlN3aXBlciIsInNwYWNlQmV0d2VlbiIsInNsaWRlc1BlclZpZXciLCJmcmVlTW9kZSIsIndhdGNoU2xpZGVzUHJvZ3Jlc3MiLCJicmVha3BvaW50cyIsInByb2R1Y3RTd2lwZXIiLCJsb29wIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsInRodW1icyIsInN3aXBlciIsImNsaWNrIiwidG9nZ2xlQ2xhc3MiLCJmYXZTdGF0dXMiLCJoYXNDbGFzcyIsImZhdlRleHQiLCJmaW5kIiwidGV4dCIsImFjY29yZGlvbiIsImNvbGxhcHNpYmxlIiwiYWN0aXZlIiwiaGVpZ2h0U3R5bGUiLCJlbmFibGVQb3B1cCIsImV2dCIsInRhcmdldCIsImlzIiwiZGlzYWJsZVBvcHVwIiwidmFsIiwiYXR0ciIsInN1Ym1pdCIsImZpbGxlZEZpZWxkcyIsImZpZWxkc051bSIsImxlbmd0aCIsImVhY2giLCJpIiwiZWxlbSIsImtleXVwIiwic2VsZWN0b3IiLCJnZXRFbGVtZW50QnlJZCIsImltIiwiSW5wdXRtYXNrIiwibWFzayIsInZhbGlkYXRpb24iLCJKdXN0VmFsaWRhdGUiLCJlcnJvckZpZWxkQ3NzQ2xhc3MiLCJlcnJvckxhYmVsQ3NzQ2xhc3MiLCJlcnJvckxhYmVsU3R5bGUiLCJjb2xvciIsImFkZEZpZWxkIiwicnVsZSIsInZhbHVlIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdG9yIiwibmFtZSIsInBob25lIiwiaW5wdXRtYXNrIiwidW5tYXNrZWR2YWx1ZSJdLCJtYXBwaW5n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QUM7RUFFRkwsVUFBVSxDQUNMTSxRQUFRLENBQUMsT0FBTyxFQUFFLENBQ2Y7SUFDSUMsSUFBSSxFQUFFLFdBQVc7SUFDakJDLEtBQUssRUFBRSxDQUFDO0lBQ1JDLFlBQVksRUFBRTtFQUNsQixDQUFDLEVBQ0Q7SUFDSUYsSUFBSSxFQUFFLFdBQVc7SUFDakJDLEtBQUssRUFBRSxFQUFFO0lBQ1RDLFlBQVksRUFBRTtFQUNsQixDQUFDLEVBQ0Q7SUFDSUYsSUFBSSxFQUFFLFVBQVU7SUFDaEJFLFlBQVksRUFBRTtFQUNsQixDQUFDLENBQ0osQ0FBQyxDQUNESCxRQUFRLENBQUMsUUFBUSxFQUFFLENBQ2hCO0lBQ0lDLElBQUksRUFBRSxVQUFVO0lBQ2hCRSxZQUFZLEVBQUU7RUFDbEIsQ0FBQyxFQUNEO0lBQ0lDLFNBQVMsRUFBRSxtQkFBQ0MsSUFBSSxFQUFFSCxLQUFLLEVBQUs7TUFDeEIsSUFBTUksS0FBSyxHQUFHakIsUUFBUSxDQUFDa0IsU0FBUyxDQUFDQyxhQUFhLEVBQUU7TUFDaEQsT0FBT0YsS0FBSyxDQUFDdEIsTUFBTSxLQUFLLEVBQUU7SUFDOUIsQ0FBQztJQUNEbUIsWUFBWSxFQUFFO0VBQ2xCLENBQUMsQ0FDSixDQUFDO0FBQ1YsQ0FBQyxDQUFDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAvLyDQntGC0LrQu9GO0YfQtdC90LjQtSAvINCy0LrQu9GO0YfQtdC90LjQtSDRgdC60YDQvtC70LvQsCDQvdCwINGB0YLRgNCw0L3QuNGG0LVcbiAgICBsZXQgYm9keVNjcm9sbENvbnRyb2xzID0ge1xuICAgICAgICBzY3JvbGxCYXJXaWR0aDogKHdpbmRvdy5pbm5lcldpZHRoIC0gJCgnYm9keScpLmNsaWVudFdpZHRoKSxcblxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCdib2R5JykuY3NzKCdtYXJnaW4tcmlnaHQnLCBgJHt0aGlzLnNjcm9sbEJhcldpZHRofXB4YCk7XG4gICAgICAgICAgICBpZiAoL2lQaG9uZXxpUGFkfGlQb2R8QW5kcm9pZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuY3NzKCdtYXJnaW4tcmlnaHQnLCAnbnVsbCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCgnaHRtbCcpLmFkZENsYXNzKCdzdG9wLXNjcm9sbCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGVuYWJsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCgnYm9keScpLmNzcygnbWFyZ2luLXJpZ2h0JywgJ251bGwnKTtcbiAgICAgICAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc3RvcC1zY3JvbGwnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFByb2R1Y3QgU3dpcGVyXG4gICAgY29uc3QgdGh1bWJzU3dpcGVyID0gbmV3IFN3aXBlcignLnRodW1icy1zd2lwZXInLCB7XG4gICAgICAgIHNwYWNlQmV0d2VlbjogMTMsXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDcsXG4gICAgICAgIGZyZWVNb2RlOiB0cnVlLFxuICAgICAgICB3YXRjaFNsaWRlc1Byb2dyZXNzOiB0cnVlLFxuICAgICAgICBicmVha3BvaW50czoge1xuICAgICAgICAgICAgOTkxOiB7XG4gICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDcsXG4gICAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogNVxuICAgICAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgICAgICAzMjA6IHtcbiAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogNS44LFxuICAgICAgICAgICAgICBzcGFjZUJldHdlZW46IDE0XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgfSk7XG4gICAgdmFyIHByb2R1Y3RTd2lwZXIgPSBuZXcgU3dpcGVyKFwiLnByb2R1Y3Qtc3dpcGVyXCIsIHtcbiAgICAgICAgbG9vcDogdHJ1ZSxcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiAxMCxcbiAgICAgICAgbmF2aWdhdGlvbjoge1xuICAgICAgICAgIG5leHRFbDogXCIuc3dpcGVyLWJ1dHRvbi1uZXh0XCIsXG4gICAgICAgICAgcHJldkVsOiBcIi5zd2lwZXItYnV0dG9uLXByZXZcIixcbiAgICAgICAgfSxcbiAgICAgICAgdGh1bWJzOiB7XG4gICAgICAgICAgc3dpcGVyOiB0aHVtYnNTd2lwZXIsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgIC8vIEFkZCB0byBmYXZcbiAgICAkKCcucHJvZHVjdF9fZmF2JykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICBsZXQgZmF2U3RhdHVzID0gISEoJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpLFxuICAgICAgICAgICAgZmF2VGV4dCA9IGZhdlN0YXR1cyA/IFwi0JIg0LjQt9Cx0YDQsNC90L3QvtC8XCIgOiBcItCSINC40LfQsdGA0LDQvdC90L7QtVwiO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJy50ZXh0LTEyJykudGV4dChmYXZUZXh0KTtcbiAgICB9KVxuXG4gICAgLy8gQWNjb3JkaW9uXG4gICAgJChmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoXCIjYWNjb3JkaW9uXCIpLmFjY29yZGlvbih7XG4gICAgICAgICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgICAgICAgICBoZWlnaHRTdHlsZTogXCJjb250ZW50XCJcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBQb3B1cHNcbiAgICAkKCcucHJvZHVjdC1mZWVkYmFjaycpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZW5hYmxlUG9wdXAoKVxuXG4gICAgICAgIC8vINCa0LvQuNC6INC/0L4g0L7QstC10YDQu9GN0Y5cbiAgICAgICAgJCgnLnByb2R1Y3RfX292ZXJsYXknKS5jbGljayhmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChldnQudGFyZ2V0KTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuaXMoJy5wcm9kdWN0X19vdmVybGF5JykpIHtcbiAgICAgICAgICAgICAgICBkaXNhYmxlUG9wdXAoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAvLyDQmtC70LjQutC4INC/0L4g0LrQvdC+0L/QutCw0Lwg0LfQsNC60YDRi9GC0LjRjyDQv9C+0L/QsNC/0L7QsiDQuNC70Lgg0LrQvdC+0L/QutC1INCe0LpcbiAgICAgICAgJCgnLnBvcHVwX19jbG9zZS1idG4sIC5wb3B1cF9fY29uZmlybS1idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkaXNhYmxlUG9wdXAoKVxuICAgICAgICB9KVxuICAgICAgICAkKCcucG9wdXBfX2NvbmZpcm0tYnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCgnLnBvcHVwLS10aGFua3MnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICQoJy5wb3B1cC0tZm9ybSAuZm9ybV9faW5wdXQnKS52YWwoJycpO1xuICAgICAgICAgICAgJCgnI2Zvcm0gI3N1Ym1pdC1idG4nKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgJCgnLnBvcHVwLS1mb3JtJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9KVxuICAgICAgICAvLyDQn9C+0YHQu9C1INGD0YHQv9C10YjQvdC+0Lkg0L7RgtC/0YDQsNCy0LrQuCDRhNC+0YDQvNGLINC/0L7QutCw0LfRi9Cy0LDQtdC8INCy0YLQvtGA0L7QuSDQv9C+0L/QsNC/XG4gICAgICAgICQoJyNmb3JtJykuc3VibWl0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJy5wb3B1cC0tZm9ybScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICQoJy5wb3B1cC0tdGhhbmtzJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBlbmFibGVQb3B1cCgpIHtcbiAgICAgICAgJCgnLnByb2R1Y3RfX292ZXJsYXknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIGJvZHlTY3JvbGxDb250cm9scy5kaXNhYmxlKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNhYmxlUG9wdXAoKSB7XG4gICAgICAgICQoJy5wcm9kdWN0X19vdmVybGF5JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICBib2R5U2Nyb2xsQ29udHJvbHMuZW5hYmxlKCk7XG4gICAgfVxuXG5cbiAgICAvLyBGb3JtXG4gICAgLy8vLyBEaXNhYmxlIEZvcm0gQnRuXG4gICAgbGV0IGZpbGxlZEZpZWxkcyxcbiAgICAgICAgZmllbGRzTnVtID0gJCgnI2Zvcm0gLmZvcm1fX2lucHV0JykubGVuZ3RoO1xuXG4gICAgJCgnI2Zvcm0gI3N1Ym1pdC1idG4nKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICQoJyNmb3JtIC5mb3JtX19pbnB1dCcpLmVhY2goZnVuY3Rpb24gKGksIGVsZW0pIHtcbiAgICAgICAgJChlbGVtKS5rZXl1cChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmaWxsZWRGaWVsZHMgPSAwO1xuICAgICAgICAgICAgJCgnI2Zvcm0gLmZvcm1fX2lucHV0JykuZWFjaChmdW5jdGlvbiAoaSwgZWxlbSkge1xuICAgICAgICAgICAgICAgIGlmICgkKGVsZW0pLnZhbCgpICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICBmaWxsZWRGaWVsZHMrK1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAkKCcjZm9ybSAjc3VibWl0LWJ0bicpLmF0dHIoJ2Rpc2FibGVkJywgIShmaWxsZWRGaWVsZHMgPT09IGZpZWxkc051bSkpXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIC8vLy8gTWFza1xuICAgIHZhciBzZWxlY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaG9uZScpO1xuICAgIHZhciBpbSA9IG5ldyBJbnB1dG1hc2soJys3ICg5OTkpIDk5OS05OS05OScpO1xuICAgIGltLm1hc2soc2VsZWN0b3IpO1xuXG4gICAgLy8vLyBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBuZXcgSnVzdFZhbGlkYXRlKCcjZm9ybScsIHtcbiAgICAgICAgZXJyb3JGaWVsZENzc0NsYXNzOiAnaXMtaW52YWxpZCcsXG4gICAgICAgIGVycm9yTGFiZWxDc3NDbGFzczogJ2lzLWxhYmVsLWludmFsaWQnLFxuICAgICAgICBlcnJvckxhYmVsU3R5bGU6IHtcbiAgICAgICAgICAgIGNvbG9yOiAnI2VmNjQ2MScsXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB2YWxpZGF0aW9uXG4gICAgICAgIC5hZGRGaWVsZCgnI25hbWUnLCBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcnVsZTogJ21pbkxlbmd0aCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6IDIsXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiAn0KHQu9C40YjQutC+0Lwg0LrQvtGA0L7RgtC60L7QtSDQuNC80Y8nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBydWxlOiAnbWF4TGVuZ3RoJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogMzAsXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiAn0KHQu9C40YjQutC+0Lwg0LTQu9C40L3QvdC+0LUg0LjQvNGPJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcnVsZTogJ3JlcXVpcmVkJyxcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6ICfQktGLINC90LUg0LLQstC10LvQuCDQuNC80Y8nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSlcbiAgICAgICAgLmFkZEZpZWxkKCcjcGhvbmUnLCBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcnVsZTogJ3JlcXVpcmVkJyxcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6ICfQktGLINC90LUg0LLQstC10LvQuCDRgtC10LvQtdGE0L7QvScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRvcjogKG5hbWUsIHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBob25lID0gc2VsZWN0b3IuaW5wdXRtYXNrLnVubWFza2VkdmFsdWUoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGhvbmUubGVuZ3RoID09PSAxMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiAn0JLQstC10LTQuNGC0LUgMTAg0YHQuNC80LLQvtC70L7QsicsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdKVxufSkiXX0=
